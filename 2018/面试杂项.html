<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.0.6" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico?v=6.0.6">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=6.0.6">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=6.0.6">


  <link rel="mask-icon" href="/images/favicon.ico?v=6.0.6" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.0.6',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>
<script>
    (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>

  




  <meta name="description" content="防止网页被嵌入框架的代码任何页面都不可嵌套1234// 判断当前的window对象是否对顶层top对象还可以使用window.top !== window.selfif (window !== top) // 如果不是，将top对象的网址自动导向被嵌入网页的网址top.location.href = window.location.href; 本地域名可嵌套，其他域名不可12345678try&amp;#">
<meta name="keywords" content="前端面试">
<meta property="og:type" content="article">
<meta property="og:title" content="面试杂项">
<meta property="og:url" content="https://fanerge.github.io/2018/面试杂项.html">
<meta property="og:site_name" content="fanerge&#39;s Blogs">
<meta property="og:description" content="防止网页被嵌入框架的代码任何页面都不可嵌套1234// 判断当前的window对象是否对顶层top对象还可以使用window.top !== window.selfif (window !== top) // 如果不是，将top对象的网址自动导向被嵌入网页的网址top.location.href = window.location.href; 本地域名可嵌套，其他域名不可12345678try&amp;#">
<meta property="og:image" content="http://p677fntmi.bkt.clouddn.com/162385d14ae83726">
<meta property="og:image" content="http://p677fntmi.bkt.clouddn.com/690666428-5ab0a22b5cbca_articlex.png">
<meta property="og:updated_time" content="2022-05-14T02:23:46.529Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="面试杂项">
<meta name="twitter:description" content="防止网页被嵌入框架的代码任何页面都不可嵌套1234// 判断当前的window对象是否对顶层top对象还可以使用window.top !== window.selfif (window !== top) // 如果不是，将top对象的网址自动导向被嵌入网页的网址top.location.href = window.location.href; 本地域名可嵌套，其他域名不可12345678try&amp;#">
<meta name="twitter:image" content="http://p677fntmi.bkt.clouddn.com/162385d14ae83726">



  <link rel="alternate" href="/atom.xml" title="fanerge's Blogs" type="application/atom+xml" />




  <link rel="canonical" href="https://fanerge.github.io/2018/面试杂项.html"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>面试杂项 | fanerge's Blogs</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband">
	<a href="https://github.com/fanerge"><img style="position: absolute; top: 0; right: 0; border: 0; z-index: 9999;" src="http://pau044s3z.bkt.clouddn.com/forkgithub.png" alt="Fork me on GitHub"></a>
	</div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> 

<div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">fanerge's Blogs</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">一个专注于WEB开发的技术的个人博客</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
          
  <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Home</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-categories">
    <a href="/categories" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />Categories<span class="badge">29</span>
      </a>
</li>

      
        
        
          
  <li class="menu-item menu-item-archives">
    <a href="/archives" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archives<span class="badge">187</span>
      </a>
</li>

      
        
        
          
  <li class="menu-item menu-item-about">
    <a href="/about" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />About</a>
</li>

      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />Search</a>
        </li>
      
    </ul>
  

  
    

    
    
      
      
    
      
      
    
      
      
    
      
      
    
    

  


  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>


  



 </div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://fanerge.github.io/2018/面试杂项.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="余真帆-fanerge">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars3.githubusercontent.com/u/17136707?s=400&u=d7250b0655c87b8e8e1cdaf826754fe5e6f68e80&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fanerge's Blogs">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">面试杂项</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-22T22:17:21+08:00">2018-01-22</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/前端面试/" itemprop="url" rel="index"><span itemprop="name">前端面试</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon"
            >
            <i class="fa fa-eye"></i>
             Views: 
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
		
	  
      

      
        <h1 id="防止网页被嵌入框架的代码"><a href="#防止网页被嵌入框架的代码" class="headerlink" title="防止网页被嵌入框架的代码"></a>防止网页被嵌入框架的代码</h1><h2 id="任何页面都不可嵌套"><a href="#任何页面都不可嵌套" class="headerlink" title="任何页面都不可嵌套"></a>任何页面都不可嵌套</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// 判断当前的window对象是否对顶层top对象还可以使用window.top !== window.self</div><div class="line">if (window !== top) </div><div class="line">// 如果不是，将top对象的网址自动导向被嵌入网页的网址</div><div class="line">top.location.href = window.location.href;</div></pre></td></tr></table></figure>
<h2 id="本地域名可嵌套，其他域名不可"><a href="#本地域名可嵌套，其他域名不可" class="headerlink" title="本地域名可嵌套，其他域名不可"></a>本地域名可嵌套，其他域名不可</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">try&#123;</div><div class="line">　　top.location.hostname;</div><div class="line">　　if (top.location.hostname !== window.location.hostname) &#123;</div><div class="line">　　　　top.location.href = window.location.href;</div><div class="line">　　&#125;</div><div class="line">&#125;catch(e)&#123;</div><div class="line">　　top.location.href = window.location.href;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>PS：上面两种对于动态生产iframe标签和禁用js不会用效果。<br>别人可能这样禁用你的js<br><code>&lt;noscript&gt;&lt;iframe src=fillseo.html&gt;&lt;/iframe&gt;&lt;/noscript&gt;</code></p>
<h2 id="js如何判断是否在iframe中"><a href="#js如何判断是否在iframe中" class="headerlink" title="js如何判断是否在iframe中"></a>js如何判断是否在iframe中</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">//方式一 </div><div class="line">if (self.frameElement &amp;&amp; self.frameElement.tagName == &quot;IFRAME&quot;) &#123; </div><div class="line">	alert(&apos;在iframe中&apos;); </div><div class="line">&#125; </div><div class="line">//方式二 </div><div class="line">if (window.frames.length != parent.frames.length) &#123; </div><div class="line">	alert(&apos;在iframe中&apos;); </div><div class="line">&#125; </div><div class="line">//方式三 </div><div class="line">if (self != top) &#123; </div><div class="line">	alert(&apos;在iframe中&apos;); </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="比较可靠的方式"><a href="#比较可靠的方式" class="headerlink" title="比较可靠的方式"></a>比较可靠的方式</h2><p>为了彻底防止别人用IFRAME框架嵌套调用自己的网页，如下方法是最可靠的.<br>这里赋值为空页面,也可赋值为你的页面的URL地址.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">if(top != self)&#123; </div><div class="line">	location.href = &quot;about:blank&quot;; </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="在meta中设置"><a href="#在meta中设置" class="headerlink" title="在meta中设置"></a>在meta中设置</h2><p><code>&lt;meta http-equiv=&quot;X-FRAME-OPTIONS&quot; content=&quot;DENY&quot;&gt;</code></p>
<h2 id="在http的header做手脚"><a href="#在http的header做手脚" class="headerlink" title="在http的header做手脚"></a>在http的header做手脚</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">header(‘X-Frame-Options:Deny&apos;);</div><div class="line">header(&quot;X-XSS-Protection: 0&quot;);</div></pre></td></tr></table></figure>
<h2 id="在Apache、IIS、Nginc主机中设置"><a href="#在Apache、IIS、Nginc主机中设置" class="headerlink" title="在Apache、IIS、Nginc主机中设置"></a>在Apache、IIS、Nginc主机中设置</h2><p><code>X-Frame-Options &quot;SAMEORIGIN&quot;;</code></p>
<h1 id="BFC"><a href="#BFC" class="headerlink" title="BFC"></a>BFC</h1><h2 id="BFC的定义"><a href="#BFC的定义" class="headerlink" title="BFC的定义"></a>BFC的定义</h2><p>块格式化上下文（Block Formatting Context，BFC） 是Web页面的可视化CSS渲染的一部分，是布局过程中生成块级盒子的区域（可以理解为独立的布局作用域），也是浮动元素与其他元素的交互限定区域。<br>具有 BFC 特性的元素可以看作是隔离了的独立容器，容器里面的元素不会在布局上影响到外面的元素，并且 BFC 具有普通容器所没有的一些特性。</p>
<h2 id="BFC的触发"><a href="#BFC的触发" class="headerlink" title="BFC的触发"></a>BFC的触发</h2><p>body 根元素或包含根元素的元素<br>浮动元素：float 除 none 以外的值<br>绝对定位元素：position (absolute、fixed)<br>display 为 inline-block、table-cells、flex<br>overflow 除了 visible 以外的值 (hidden、auto、scroll)</p>
<h2 id="BFC的运用"><a href="#BFC的运用" class="headerlink" title="BFC的运用"></a>BFC的运用</h2><p>同一个 BFC 下外边距会发生折叠<br>BFC 可以包含浮动的元素（清除浮动）（父容器设置为overflow: hidden;即可清除浮动）<br>BFC 可以阻止元素被浮动元素覆盖（为原本被覆盖的元素设置overflow: hidden;是该元素触发BFC解决问题）<br><a href="https://zhuanlan.zhihu.com/p/25321647" target="_blank" rel="external">10 分钟理解 BFC 原理</a></p>
<h1 id="Banner如何平滑的从最后一张过渡到第一张"><a href="#Banner如何平滑的从最后一张过渡到第一张" class="headerlink" title="Banner如何平滑的从最后一张过渡到第一张"></a>Banner如何平滑的从最后一张过渡到第一张</h1><p>1.如有1,2,3,4张banner需要轮播，对应图片顺序为：4,1,2,3,4,1<br>2.动画结束后改变left定位到前面的1，这个过程页面看不出变化。<br><a href="https://segmentfault.com/q/1010000002585081/a-1020000002585201" target="_blank" rel="external">图片轮播，第一张图片和最后一张图片怎么过渡？</a></p>
<h1 id="Event-Loop（浏览器环境）"><a href="#Event-Loop（浏览器环境）" class="headerlink" title="Event Loop（浏览器环境）"></a>Event Loop（浏览器环境）</h1><p>定义：为了协调事件（event），用户交互（user interaction），脚本（script），渲染（rendering），网络（networking）等，用户代理（user agent）必须使用事件循环（event loops）。即事件循环，是JavaScript引擎处理异步任务的方式。为了让单线程的JavaScript通畅的跑起来，所有的异步操作都要被合适的处理，这个处理逻辑就叫做Event Loop。<br><a href="https://html.spec.whatwg.org/multipage/webappapis.html#event-loops" target="_blank" rel="external">HTML标准-Event loops</a></p>
<h2 id="堆、栈、队列"><a href="#堆、栈、队列" class="headerlink" title="堆、栈、队列"></a>堆、栈、队列</h2><h3 id="堆（heap）"><a href="#堆（heap）" class="headerlink" title="堆（heap）"></a>堆（heap）</h3><p>堆（heap）是指程序运行时申请的动态内存，在JS运行时用来存放对象。</p>
<h3 id="栈（stack）"><a href="#栈（stack）" class="headerlink" title="栈（stack）"></a>栈（stack）</h3><p>栈（stack）遵循的原则是“先进后出”，JS种的基本数据类型与指向对象的地址存放在栈内存中，此外还有一块栈内存用来执行JS主线程–执行栈（execution context stack），这里只考虑执行栈。</p>
<h3 id="队列（queue）"><a href="#队列（queue）" class="headerlink" title="队列（queue）"></a>队列（queue）</h3><p>队列（queue）遵循的原则是“先进先出”，JS中除了主线程之外还存在两个“任务队列”（微任务队列microTask和宏任务队列macroTask）。</p>
<h2 id="js中的两个队列"><a href="#js中的两个队列" class="headerlink" title="js中的两个队列"></a>js中的两个队列</h2><p>在JavaScript中，任务被分为Task（又称为MacroTask,宏任务）和MicroTask（微任务）两种。<br>MicroTask: process.nextTick（node独有）, Promises, Object.observe(废弃), MutationObserver<br>MacroTask: script(同步代码), setTimeout, setInterval, setImmediate（node独有）, I/O, UI rendering（浏览器独有）<br>javascript执行：总的执行顺序为同步代码script—&gt;microTask—&gt;其他macroTask，在执行microTask、macroTask是产生新的异步操作，如此一来就形成了循环。<br>具体来说，浏览器会不断从task队列中按顺序取task执行，每执行完一个task都会检查microtask队列是否为空（执行完一个task的具体标志是函数执行栈为空），如果不为空则会一次性执行完所有microtask。然后再进入下一个循环去task队列中取下一个task执行，以此类推。</p>
<h2 id="Philip-Roberts的演讲《Help-I’m-stuck-in-an-event-loop》的event-loop-图"><a href="#Philip-Roberts的演讲《Help-I’m-stuck-in-an-event-loop》的event-loop-图" class="headerlink" title="Philip Roberts的演讲《Help, I’m stuck in an event-loop》的event-loop 图"></a>Philip Roberts的演讲《Help, I’m stuck in an event-loop》的event-loop 图</h2><p><img src="http://p677fntmi.bkt.clouddn.com/162385d14ae83726" alt="Philip Roberts的演讲《Help, I&#39;m stuck in an event-loop》"><br>PS：在执行MicroTask和MacroTask时，如果产生了新的MicroTask则会在本次Event Loop中执行，产生的MacroTask会在下个Event Loop中执行。（更新于2018-09-12）<br><a href="https://juejin.im/post/5b8f76675188255c7c653811" target="_blank" rel="external">带你彻底弄懂Event Loop</a></p>
<h2 id="解释"><a href="#解释" class="headerlink" title="解释"></a>解释</h2><blockquote>
<p>   当主线程运行的时候,JS会产生堆和栈(执行栈)<br>主线程中调用的webaip所产生的异步操作(dom事件、ajax回调、定时器等)只要产生结果，就把这个回调塞进“任务队列”中等待执行。<br>当主线程中的同步任务执行完毕，系统就会依次读取“任务队列”中的任务，将任务放进执行栈中执行。<br>执行任务时可能还会产生新的异步操作，会产生新的循环，整个过程是循环不断的。<br><a href="https://juejin.im/post/5aab2d896fb9a028b86dc2fd" target="_blank" rel="external">JavaScript 运行机制–Event Loop详解</a><br><a href="https://segmentfault.com/a/1190000013861128" target="_blank" rel="external">一篇文章教会你Event loop——浏览器和Node</a></p>
</blockquote>
<h1 id="Event-Loop（Node环境）"><a href="#Event-Loop（Node环境）" class="headerlink" title="Event Loop（Node环境）"></a>Event Loop（Node环境）</h1><p>Node使用了libuv库来实现Event loop。</p>
<h2 id="Event-Loop顺序"><a href="#Event-Loop顺序" class="headerlink" title="Event Loop顺序"></a>Event Loop顺序</h2><p>nodejs的event loop分为6个阶段，它们会按照顺序反复运行，分别如下：</p>
<ol>
<li>timers：执行setTimeout() 和 setInterval()中到期的callback。</li>
<li>I/O callbacks：上一轮循环中有少数的I/Ocallback会被延迟到这一轮的这一阶段执行</li>
<li>idle, prepare：队列的移动，仅内部使用</li>
<li>poll：最为重要的阶段，执行I/O callback，在适当的条件下会阻塞在这个阶段</li>
<li>check：执行setImmediate的callback</li>
<li>close callbacks：执行close事件的callback，例如socket.on(“close”,func)<br><img src="http://p677fntmi.bkt.clouddn.com/690666428-5ab0a22b5cbca_articlex.png" alt="Node-Event Loop"><br>不同于浏览器的是，在每个阶段完成后，而不是MacroTask任务完成后，microTask队列就会被执行。这就导致了同样的代码在不同的上下文环境下会出现不同的结果。<br>另外需要注意的是，如果在timers阶段执行时创建了setImmediate则会在此轮循环的check阶段执行，如果在timers阶段创建了setTimeout，由于timers已取出完毕，则会进入下轮循环，check阶段创建timers任务同理。<br><a href="https://segmentfault.com/a/1190000013861128" target="_blank" rel="external">一篇文章教会你Event loop——浏览器和Node</a></li>
</ol>
<h1 id="RegExp相关知识点"><a href="#RegExp相关知识点" class="headerlink" title="RegExp相关知识点"></a>RegExp相关知识点</h1><p>RegExp 构造函数创建了一个正则表达式对象，用于将文本与一个模式匹配[2018-03-27]。</p>
<h2 id="正则flags的说明"><a href="#正则flags的说明" class="headerlink" title="正则flags的说明"></a>正则flags的说明</h2><p>g–全局匹配;找到所有匹配，而不是在第一个匹配后停止<br>i–忽略大小写<br>m–多行; 将开始和结束字符（^和$）视为在多行上工作（也就是，分别匹配每一行的开始和结束（由 \n 或 \r 分割），而不只是只匹配整个输入字符串的最开始和最末尾处<br>u–Unicode; 将模式视为Unicode序列点的序列<br>y–粘性匹配; 仅匹配目标字符串中此正则表达式的lastIndex属性指示的索引(并且不尝试从任何后续的索引匹配)</p>
<h2 id="正则表达式中特殊字符的含义"><a href="#正则表达式中特殊字符的含义" class="headerlink" title="正则表达式中特殊字符的含义"></a>正则表达式中特殊字符的含义</h2><h3 id="字符类别（Character-Classes）"><a href="#字符类别（Character-Classes）" class="headerlink" title="字符类别（Character Classes）"></a>字符类别（Character Classes）</h3><h4 id=""><a href="#" class="headerlink" title="."></a>.</h4><p>点号，小数点，匹配任意单个字符（但不包括行结束符\n \r等）。<br>例如，/.y/ 匹配 “yes make my day” 中的 “my” 和 “ay”，但是不匹配 “yes”。</p>
<h4 id="d"><a href="#d" class="headerlink" title="\d"></a>\d</h4><p>匹配任意阿拉伯数字。等价于[0-9]。<br>例如，/\d/ 或 /[0-9]/ 匹配 “B2 is the suite number.” 中的 ‘2’。 </p>
<h4 id="D"><a href="#D" class="headerlink" title="\D"></a>\D</h4><p>匹配任意一个不是阿拉伯数字的字符。等价于[^0-9]。<br>例如，/\D/ 或 /[^0-9]/ 匹配 “B2 is the suite number.” 中的 ‘B’。<br>PS：由于没有全局匹配，只能匹配到一个’B’就结束匹配。</p>
<h4 id="w"><a href="#w" class="headerlink" title="\w"></a>\w</h4><p>匹配任意来自基本拉丁字母表中的字母数字字符，还包括下划线。等价于 [A-Za-z0-9_]。<br>例如，/\w/ 匹配 “apple” 中的 ‘a’，”$5.28” 中的 ‘5’ 和 “3D” 中的 ‘3’。</p>
<h4 id="W"><a href="#W" class="headerlink" title="\W"></a>\W</h4><p>匹配任意不是基本拉丁字母表中单词（字母数字下划线）字符的字符。等价于 [^A-Za-z0-9<em>]。<br>例如，/\W/ 或 /[^A-Za-z0-9</em>]/ 匹配 “50%” 中的 ‘%’。</p>
<h4 id="s"><a href="#s" class="headerlink" title="\s"></a>\s</h4><p>匹配一个空白符，包括空格、制表符、换页符、换行符和其他 Unicode 空格。<br>例如 /\s\w*/ 匹配 “foo bar” 中的 ‘ bar’。</p>
<h4 id="S"><a href="#S" class="headerlink" title="\S"></a>\S</h4><p>匹配一个非空白符。<br>例如，/\S\w*/ 匹配 “foo bar” 中的 ‘foo’。<br>PS：经常使用[\s\S]来匹配所有字符。</p>
<h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><p>\t    匹配一个水平制表符（tab）<br>\r    匹配一个回车符（carriage return）<br>\n    匹配一个换行符（linefeed）<br>\v    匹配一个垂直制表符（vertical tab）<br>\f    匹配一个换页符（form-feed）<br>[\b]    匹配一个退格符（backspace）（不要与 \b 混淆）<br>\0    匹配一个 NUL 字符。不要在此后面跟小数点。<br>\xhh    匹配编码为 hh （两个十六进制数字）的字符。<br>\uhhhh    匹配 Unicode 值为 hhhh （四个十六进制数字）的字符。<br>\      发生转义<br>例如，<em> 是一个特殊字符，表示匹配某个字符 0 或多次，如 /a</em>/ 意味着 0 或多个 “a”。 为了匹配字面意义上的 <em> ，在它前面加上一个反斜杠，例如，/a\</em>/匹配 ‘a*’。</p>
<h2 id="字符集合（Character-Sets）"><a href="#字符集合（Character-Sets）" class="headerlink" title="字符集合（Character Sets）"></a>字符集合（Character Sets）</h2><h3 id="xyz"><a href="#xyz" class="headerlink" title="[xyz]"></a>[xyz]</h3><p>匹配集合中的任意一个字符。你可以使用连字符’-‘指定一个范围。<br>例如，[abcd] 等价于 [a-d]，匹配”brisket”中的’b’和”chop”中的’c’。</p>
<h3 id="xyz-1"><a href="#xyz-1" class="headerlink" title="[^xyz]"></a>[^xyz]</h3><p>一个反义或补充字符集，也叫反义字符组。<br>例如，[^abc] 等价于 [^a-c]。 第一个匹配的是 “bacon” 中的’o’ 和 “chop” 中的 ‘h’。</p>
<h2 id="边界（Boundaries）"><a href="#边界（Boundaries）" class="headerlink" title="边界（Boundaries）"></a>边界（Boundaries）</h2><h3 id="-1"><a href="#-1" class="headerlink" title="^"></a>^</h3><p>匹配输入开始。如果多行（multiline）标志被设为 true，该字符也会匹配一个断行（line break）符后的开始处。<br>例如，/^A/ 不匹配 “an A” 中的 “A”，但匹配 “An A” 中的 “A”。</p>
<h3 id="-2"><a href="#-2" class="headerlink" title="$"></a>$</h3><p>匹配输入结尾。如果多行（multiline）标志被设为 true，该字符也会匹配一个断行（line break）符的前的结尾处。<br>例如，/t$/ 不匹配 “eater” 中的 “t”，但匹配 “eat” 中的 “t”。</p>
<h3 id="b"><a href="#b" class="headerlink" title="\b"></a>\b</h3><p>如果符合要求就一直往后匹配，一直到无法匹配为止，这就是贪婪模式。所谓的惰性模式就是一旦匹配到合适的就结束，不在继续匹配下去了。</p>
<h2 id="分组（Grouping）与反向引用（back-references）"><a href="#分组（Grouping）与反向引用（back-references）" class="headerlink" title="分组（Grouping）与反向引用（back references）"></a>分组（Grouping）与反向引用（back references）</h2><h3 id="先行断言（lookahead）"><a href="#先行断言（lookahead）" class="headerlink" title="先行断言（lookahead）"></a>先行断言（lookahead）</h3><h4 id="先行肯定断言"><a href="#先行肯定断言" class="headerlink" title="先行肯定断言"></a>先行肯定断言</h4><p>x(?=y)<br>只有当 x 后面紧跟着 y 时，才匹配 x。<br>/Jack(?=Sprat|Frost)/ 只有在 ‘Jack’ 后面紧跟着 ‘Sprat’ 或 ‘Frost’ 时，才会匹配它。然而，’Sprat’ 或 ‘Frost’ 都不是匹配结果的一部分。</p>
<h4 id="先行否定断言"><a href="#先行否定断言" class="headerlink" title="先行否定断言"></a>先行否定断言</h4><p>x(?!y)<br>只有当 x 后面不是紧跟着 y 时，才匹配 x。<br>只有当 x 后面不是紧跟着 y 时，才匹配 x。例如，/\d+(?!.)/ 只有当一个数字后面没有紧跟着一个小数点时，才会匹配该数字。/\d+(?!.)/.exec(“3.141”) 匹配 141 而不是 3.141。</p>
<h3 id="后行断言（lookbehind）"><a href="#后行断言（lookbehind）" class="headerlink" title="后行断言（lookbehind）"></a>后行断言（lookbehind）</h3><p>这是ES2018新加的标准</p>
<h4 id="后行肯定断言"><a href="#后行肯定断言" class="headerlink" title="后行肯定断言"></a>后行肯定断言</h4><p>(?&lt;=y)x<br>只有当 x 前面紧跟 y 时，才匹配 x。<br>例如：/(?&lt;=\$)\d+/.exec(‘$1000’) // 1000</p>
<h4 id="后行否定断言"><a href="#后行否定断言" class="headerlink" title="后行否定断言"></a>后行否定断言</h4><p>(?&lt;!y)x<br>只有当 x 前面紧不是跟 y 时，才匹配 x。<br>例如：/(?&lt;!\$)\d+/.exec(‘$99¥1000’) // 99</p>
<h1 id="获取元素的尺寸"><a href="#获取元素的尺寸" class="headerlink" title="获取元素的尺寸"></a>获取元素的尺寸</h1><h2 id="window-getComputedStyle-element-pseudoElt"><a href="#window-getComputedStyle-element-pseudoElt" class="headerlink" title="window.getComputedStyle(element, [pseudoElt])"></a>window.getComputedStyle(element, [pseudoElt])</h2><p>定义：Window.getComputedStyle() 方法给出应用活动样式表后的元素的所有CSS属性的值，并解析这些值可能包含的任何基本计算。<br>参数：<br>element<br>    用于获取计算样式的Element<br>pseudoElt 可选<br>    指定一个要匹配的伪元素的字符串。必须对普通元素省略（或null）。<br>返回：返回的样式是一个实时的 CSSStyleDeclaration 对象，当元素的样式更改时，它会自动更新本身。<br>兼容性处理：window.getComputedStyle ? window.getComputedStyle(ele, null) : ele.currentStyle<br>可以通过height属性和getPropertyValue(“height”)获取height值。</p>
<h2 id="elem-getBoundingClientRect"><a href="#elem-getBoundingClientRect" class="headerlink" title="elem.getBoundingClientRect()"></a>elem.getBoundingClientRect()</h2><p>定义：Element.getBoundingClientRect()方法返回元素的大小及其相对于视口的位置。<br>返回：top、right、bottom、left（相对于视口）width、right。</p>
<h2 id="元素的属性"><a href="#元素的属性" class="headerlink" title="元素的属性"></a>元素的属性</h2><p>content+padding：clientWidth\clientHeight<br>content+padding+border: offsetWidth\offsetHeight</p>
<h1 id="埋点"><a href="#埋点" class="headerlink" title="埋点"></a>埋点</h1><p>定义：埋点分析，是网站分析的一种常用的数据采集方法。数据埋点分为初级、中级、高级三种方式。数据埋点是一种良好的私有化部署数据采集方式。<br>实现步骤：埋点阶段 -&gt; 数据收集阶段 -&gt; 后端处理阶段</p>
<h2 id="买点分类"><a href="#买点分类" class="headerlink" title="买点分类"></a>买点分类</h2><h3 id="适合前端埋点"><a href="#适合前端埋点" class="headerlink" title="适合前端埋点"></a>适合前端埋点</h3><ol>
<li>运营初级阶段，产品功能相对简单（无明确业务数据、交易数据，仅通过UV、PV、点击量等基本指标分析即可满足需求）</li>
<li>需求分析与后端没有交互的前端行为（运营人员工作需要判断前端界面设计是否合理）<h3 id="适合后端埋点"><a href="#适合后端埋点" class="headerlink" title="适合后端埋点"></a>适合后端埋点</h3></li>
<li>追求精细化运营，需要进行多维度数据分析</li>
<li>包含用户资产、用户账户、风控辅助数据等重点业务数据</li>
<li>对数据安全性要求比较高</li>
<li>前端和后端都可以采集到的数据，应优先考虑后端埋点<h2 id="前端埋点（实现步骤）"><a href="#前端埋点（实现步骤）" class="headerlink" title="前端埋点（实现步骤）"></a>前端埋点（实现步骤）</h2><h3 id="埋点-1"><a href="#埋点-1" class="headerlink" title="埋点"></a>埋点</h3>以Google Analytics分析为例<br>在页面上插入一段js代码，被称为埋点代码。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;script type=&quot;text/javascript&quot;&gt;  </div><div class="line">    var _maq = _maq || []; // 全局的数组，放采集到的数据 </div><div class="line">    _maq.push([&apos;_setAccount&apos;, &apos;uuid&apos;]); // 默认放了_setAccount用于设置网站标识ID，这个标识ID是在注册GA时分配的。 </div><div class="line">    (function () &#123;  </div><div class="line">        var ma = document.createElement(&apos;script&apos;);  </div><div class="line">        ma.type = &apos;text/javascript&apos;;  </div><div class="line">        ma.async = true;  </div><div class="line">        ma.src = &quot;http://localhost:8091/data/js/ma.js&quot;;  </div><div class="line">        var s = document.getElementsByTagName(&apos;script&apos;)[0];  </div><div class="line">        s.parentNode.insertBefore(ma, s);  </div><div class="line">    &#125;)();  </div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>PS：匿名函数，这段代码的主要目的就是引入一个外部的js文件（ga.js），方式是通过document.createElement方法创建一个script并根据协议（http或https）将src指向对应的ga.js，最后将这个element插入页面的dom树上。<br>注意ga.async = true的意思是异步调用外部js文件，即不阻塞浏览器的解析，待外部js下载完成后异步执行。这个属性是HTML5新引入的。</p>
<h3 id="数据采集（之前动态插入的ma-js）"><a href="#数据采集（之前动态插入的ma-js）" class="headerlink" title="数据采集（之前动态插入的ma.js）"></a>数据采集（之前动态插入的ma.js）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">(function () &#123;</div><div class="line">    var params = &#123;&#125;;</div><div class="line">    //Document对象数据</div><div class="line">    if(document) &#123;</div><div class="line">        params.domain = document.domain || &apos;&apos;; </div><div class="line">        params.url = document.URL || &apos;&apos;; </div><div class="line">        params.title = document.title || &apos;&apos;; </div><div class="line">        params.referrer = document.referrer || &apos;&apos;; </div><div class="line">    &#125;   </div><div class="line">    //Window对象数据</div><div class="line">    if(window &amp;&amp; window.screen) &#123;</div><div class="line">        params.sh = window.screen.height || 0;</div><div class="line">        params.sw = window.screen.width || 0;</div><div class="line">        params.cd = window.screen.colorDepth || 0;</div><div class="line">    &#125;   </div><div class="line">    //navigator对象数据</div><div class="line">    if(navigator) &#123;</div><div class="line">        params.lang = navigator.language || &apos;&apos;; </div><div class="line">    &#125;   </div><div class="line">    //解析_maq配置</div><div class="line">    if(_maq) &#123;</div><div class="line">        for(var i in _maq) &#123;</div><div class="line">            switch(_maq[i][0]) &#123;</div><div class="line">                case &apos;_setAccount&apos;:</div><div class="line">                    params.account = _maq[i][1];</div><div class="line">                    break;</div><div class="line">                default:</div><div class="line">                    break;</div><div class="line">            &#125;   </div><div class="line">        &#125;   </div><div class="line">    &#125;   </div><div class="line">    //拼接参数串</div><div class="line">    var args = &apos;&apos;; </div><div class="line">    for(var i in params) &#123;</div><div class="line">        if(args != &apos;&apos;) &#123;</div><div class="line">            args += &apos;&amp;&apos;;</div><div class="line">        &#125;   </div><div class="line">        args += i + &apos;=&apos; + encodeURIComponent(params[i]);</div><div class="line">    &#125;   </div><div class="line"> </div><div class="line">    //通过Image对象请求后端脚本</div><div class="line">    var img = new Image(1, 1); </div><div class="line">    img.src = &apos;http://analytics.codinglabs.org/1.gif?&apos; + args;</div><div class="line">&#125;)();</div></pre></td></tr></table></figure>
<p>PS：为什么使用图片请求后端controller而不是ajax直接访问？原因在于ajax不能跨域请求，ma.js和后端分析的代码可能不在相同的域内，ajax做不到，而将image对象的src属性指向后端脚本并携带参数，就轻松实现了跨域请求。</p>
<h3 id="后端处理"><a href="#后端处理" class="headerlink" title="后端处理"></a>后端处理</h3><p>后端脚本一般做下面几件事：<br>（1）解析http请求参数的到信息。<br>（2）从服务器（WebServer）中获取一些客户端无法获取的信息，如访客ip等。<br>（3）将信息按格式写入log。<br>（4）生成一副1×1的空gif图片作为响应内容并将响应头的Content-type设为image/gif。<br>（5）在响应头中通过Set-cookie设置一些需要的cookie信息（作为跟踪唯一访客）。<br><a href="http://www.woshipm.com/data-analysis/665420.html" target="_blank" rel="external">前端埋点和后端埋点，哪个更科学？</a><br><a href="https://blog.csdn.net/hxyascx/article/details/53373916" target="_blank" rel="external">用户行为日志-js埋点（一）实现整体流程</a><br><a href="https://mixpanel.com/help/reference/javascript" target="_blank" rel="external">开源埋点库MixPanel</a></p>
<h1 id="File"><a href="#File" class="headerlink" title="File"></a>File</h1><p>文件(File) 接口提供有关文件的信息，并允许网页中的 JavaScript 访问其内容。</p>
<h2 id="files属性"><a href="#files属性" class="headerlink" title="files属性"></a>files属性</h2><p>用于获取当前文件数组相关的信息，每个元素有下列属性（均为只读属性）。<br>File.lastModified<br>File.name<br>File.size 单位为B。<br>File.webkitRelativePath<br>File.type 返回文件的 多用途互联网邮件扩展类型 </p>
<h2 id="FileReader-构造函数"><a href="#FileReader-构造函数" class="headerlink" title="FileReader() 构造函数"></a>FileReader() 构造函数</h2><p>FileReader 对象允许Web应用程序异步读取存储在用户计算机上的文件（或原始数据缓冲区）的内容，使用 File 或 Blob 对象指定要读取的文件或数据。<br>FileReader.abort()<br>该方法可以取消 FileReader 的读取操作，触发之后 readyState 为已完成（DONE）。<br>FileReader.readAsArrayBuffer()<br>开始读取指定的 Blob中的内容, 一旦完成, result 属性中保存的将是被读取文件的 ArrayBuffer 数据对象.<br>FileReader.readAsBinaryString()<br>开始读取指定的Blob中的内容。一旦完成，result属性中将包含所读取文件的原始二进制数据。<br>FileReader.readAsBinaryString()<br>开始读取指定的Blob中的内容。一旦完成，result属性中将包含所读取文件的原始二进制数据。<br>FileReader.readAsText()<br>开始读取指定的Blob中的内容。一旦完成，result属性中将包含一个字符串以表示所读取的文件内容。</p>
<h1 id="前端错误收集"><a href="#前端错误收集" class="headerlink" title="前端错误收集"></a>前端错误收集</h1><h2 id="window-onerror（大部分的错误）"><a href="#window-onerror（大部分的错误）" class="headerlink" title="window.onerror（大部分的错误）"></a>window.onerror（大部分的错误）</h2><p>window.onerror = function(message, source, lineno, colno, error) { … }<br>PS：</p>
<ol>
<li>由于网络请求异常事件不会冒泡，需要在捕获阶段进行处理</li>
<li>不能捕获promise的错误信息</li>
<li>跨域资源需要专门处理，需要在script标签加上crossorigin属性，服务器设置Access-Control-Allow-Origin</li>
<li>window.onerror 函数只有在返回 true 的时候，异常才不会向上抛出，否则即使是知道异常的发生控制台还是会显示 Uncaught Error: xxxxx。</li>
</ol>
<h2 id="promise的错误处理"><a href="#promise的错误处理" class="headerlink" title="promise的错误处理"></a>promise的错误处理</h2><p>promise除了使用catch方法来捕获错误，还可以使用window的unhandledrejection事件捕获异常<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">window.addEventListener(&quot;unhandledrejection&quot;, function (event) &#123;</div><div class="line">  console.warn(&quot;WARNING: Unhandled promise rejection. Shame on you! Reason: &quot;</div><div class="line">               + event.reason);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h2 id="try-catch"><a href="#try-catch" class="headerlink" title="try catch"></a>try catch</h2><p>try catch只能捕获同步代码的异常，对回调，setTimeout，promise等无能为力</p>
<h2 id="上报错误"><a href="#上报错误" class="headerlink" title="上报错误"></a>上报错误</h2><ol>
<li>后端提供接口，前端ajax上传</li>
<li>创建一个新的图片，url参数带上错误信息（跨域）</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">function report(error) &#123;</div><div class="line">  var reportUrl = &apos;http://xxxx/report&apos;;</div><div class="line">  new Image().src = reportUrl + &apos;error=&apos; + error;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><a href="http://www.aliued.com/?p=4162" target="_blank" rel="external">阿里UED前端监控</a></p>
<h1 id="npx"><a href="#npx" class="headerlink" title="npx"></a>npx</h1><p>引入这个命令的目的是为了提升开发者使用包内提供的命令行工具的体验。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npx create-react-app my-cool-new-app</div></pre></td></tr></table></figure></p>
<p>这条命令会临时安装 create-react-app 包，命令完成后 create-react-app 会删掉，不会出现在 global 中。下次再执行，还是会重新临时安装。</p>
<h1 id="判断浏览器对某个css3是否支持"><a href="#判断浏览器对某个css3是否支持" class="headerlink" title="判断浏览器对某个css3是否支持"></a>判断浏览器对某个css3是否支持</h1><h2 id="‘样式属性名’-in-document-documentElement-style"><a href="#‘样式属性名’-in-document-documentElement-style" class="headerlink" title="‘样式属性名’ in document.documentElement.style"></a>‘样式属性名’ in document.documentElement.style</h2><p>‘transform’ in document.documentElement.style // true<br>PS：兼容性较好，ie6+</p>
<h2 id="supports"><a href="#supports" class="headerlink" title="@supports"></a>@supports</h2><p>此方法为css属性<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">@supports (display: flex) &#123;</div><div class="line">	div &#123; display: flex; &#125;</div><div class="line">&#125;</div><div class="line">@supports not (display: flex) &#123;</div><div class="line">	div &#123; float: left; &#125; /* 替换样式 */</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>通常关系链接符有 not、or、and等</p>
<h2 id="CSS-supports"><a href="#CSS-supports" class="headerlink" title="CSS.supports"></a>CSS.supports</h2><p>CSS.supports(propertyName, value) || CSS.supports(supportCondition)<br>CSS.supports() 静态方法返回一个Boolean值，用来校验浏览器是否支持一个给定的CSS特性。<br>该方法有两种参数形式：</p>
<ol>
<li>propertyName：属性名，value：属性值。</li>
<li>supportCondition：需要一个匹配@supports条件的参数。 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">result = CSS.supports(&apos;(--foo: red)&apos;); // true第一种形式</div><div class="line">result = CSS.supports(&quot;( transform-origin: 5% 5% )&quot;); // true第二种形式</div></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="装饰者模式"><a href="#装饰者模式" class="headerlink" title="装饰者模式"></a>装饰者模式</h1><p>装饰者模式（Decorator Pattern）：在不改变原类和继承的情况下动态扩展对象功能，通过包装一个对象来实现一个新的具有原对象相同接口的新的对象。<br>装饰者用于通过重载方法的形式添加新功能，该模式可以在被装饰者前面或者后面加上自己的行为以达到特定的目的。<br>装饰者模式是为已有功能动态地添加更多功能的一种方式，把每个要装饰的功能放在单独的函数里，然后用该函数包装所要装饰的已有函数对象，因此，当需要执行特殊行为的时候，调用代码就可以根据需要有选择地、按顺序地使用装饰功能来包装对象。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">//需要装饰的类（函数）</div><div class="line">function Macbook() &#123;</div><div class="line"> this.cost = function () &#123;</div><div class="line">  return 1000;</div><div class="line"> &#125;;</div><div class="line">&#125; </div><div class="line">//计算商品的包装费</div><div class="line">function PackagingFee(macbook) &#123;</div><div class="line"> this.cost = function () &#123;</div><div class="line">  return macbook.cost() + 75;</div><div class="line"> &#125;;</div><div class="line">&#125;</div><div class="line">//计算商品的运费</div><div class="line">function Freight(macbook) &#123;</div><div class="line"> this.cost = function () &#123;</div><div class="line">  return macbook.cost() + 300;</div><div class="line"> &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">let money1 = new Macbook()  // 只包含mac 1000</div><div class="line">let money2 = new PackagingFee(new Macbook()) // 只包含mac + 包装费 1075 </div><div class="line">let money4 = new Freight(new Macbook()) // 只包含mac + 运费 1300</div><div class="line">let money3 = new Freight(new PackagingFee(new Macbook())) // 包含mac + 包装费 + 运费 1375</div></pre></td></tr></table></figure></p>
<h1 id="touchstart-和-click-的坑"><a href="#touchstart-和-click-的坑" class="headerlink" title="touchstart 和 click 的坑"></a>touchstart 和 click 的坑</h1><h2 id="产生原因："><a href="#产生原因：" class="headerlink" title="产生原因："></a>产生原因：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">var tap = &apos;ontouchstart&apos; in window ? &apos;touchstart&apos; : &apos;click&apos;;</div><div class="line">wrap.addEvenListener(tap, function()&#123;</div><div class="line">    signUp();</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>通过上面代码简单为用户设置事件类型，但我们忽略了‘联想触控笔记本’，<span color="color: red">由于该笔记本支持‘touchstart’事件，但当用户使用鼠标时却不能触发‘touchstart’事件</span>，造成不能触发对应的事件处理函数。</p>
<ol>
<li>有些 PC 设备屏幕为触摸屏，同时支持touchstart和click事件；</li>
<li>用户触发touchstart事件，默认必然会导致触发click事件，但是触发click事件，不一定会导致touchstart事件被触发；</li>
<li>此类设备外接鼠标时，通过上面的绑定方式，会绑定touchstart事件，但是鼠标操作只能触发click，导致touchstart不触发；</li>
</ol>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><h3 id="均使用click事件（移动端存在300ms延迟）"><a href="#均使用click事件（移动端存在300ms延迟）" class="headerlink" title="均使用click事件（移动端存在300ms延迟）"></a>均使用click事件（移动端存在300ms延迟）</h3><h3 id="通过UA判断设备是否为移动端，再确认事件类型"><a href="#通过UA判断设备是否为移动端，再确认事件类型" class="headerlink" title="通过UA判断设备是否为移动端，再确认事件类型"></a>通过UA判断设备是否为移动端，再确认事件类型</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">function isMobile() &#123;</div><div class="line">    return navigator.userAgent.match(/(blackberry|configuration\/cldc|hp |hp-|htc |htc_|htc-|iemobile|kindle|midp|mmp|motorola|mobile|nokia|opera mini|opera |Googlebot-Mobile|YahooSeeker\/M1A1-R2D2|android|iphone|ipod|mobi|palm|palmos|pocket|portalmmm|ppc;|smartphone|sonyericsson|sqh|spv|symbian|treo|up.browser|up.link|vodafone|windows ce|xda |xda_)/i) ? true : false;</div><div class="line">&#125;</div><div class="line"> var tap = isMobile() ? &apos;touchstart&apos; : &apos;click&apos;;</div></pre></td></tr></table></figure>
<h3 id="全部使用click，通过FastClick解决300毫秒的延迟问题"><a href="#全部使用click，通过FastClick解决300毫秒的延迟问题" class="headerlink" title="全部使用click，通过FastClick解决300毫秒的延迟问题"></a>全部使用click，通过FastClick解决300毫秒的延迟问题</h3><h3 id="不再绑定的时候进行判断，而是对touchstart-和-click-同时绑定，但是在-touchstart-触发的时候暂停取消后续-click-的响应。"><a href="#不再绑定的时候进行判断，而是对touchstart-和-click-同时绑定，但是在-touchstart-触发的时候暂停取消后续-click-的响应。" class="headerlink" title="不再绑定的时候进行判断，而是对touchstart 和 click 同时绑定，但是在 touchstart 触发的时候暂停取消后续 click 的响应。"></a>不再绑定的时候进行判断，而是对touchstart 和 click 同时绑定，但是在 touchstart 触发的时候暂停取消后续 click 的响应。</h3><p>具体实现：</p>
<ol>
<li>在touchstart事件响应中调用preventDefault()方法，阻止后续click事件的触发（也会阻止多个事件绑定叠加和多人合作项目，导致以来 click 事件出现bug）</li>
<li>在touchstart事件中设置一些标记，或者取消click事件的绑定，使得click事件触发时不会触发我们绑定的逻辑，在一段时间（例如300-500ms）后再恢复</li>
<li>直接对事件处理函数进行节流（throttle），保证在一段时间内（300ms - 500ms），事件处理函数只触发一次</li>
</ol>
<h1 id="defer和async"><a href="#defer和async" class="headerlink" title="defer和async"></a>defer和async</h1><p>defer：载入 JavaScript 文件时不阻塞 HTML 的解析（并行），执行阶段被放到 HTML 标签解析完成之后（DOMContentLoaded之前）。<br>async：与 defer 的区别在于，如果已经加载好，就会开始执行——无论此刻是 HTML 解析阶段还是 DOMContentLoaded 触发之后，但一定在load触发之前执行。</p>
<h1 id="从输入url到页面渲染优化"><a href="#从输入url到页面渲染优化" class="headerlink" title="从输入url到页面渲染优化"></a>从输入url到页面渲染优化</h1><h2 id="大值步骤"><a href="#大值步骤" class="headerlink" title="大值步骤"></a>大值步骤</h2><p>DNS域名解析-&gt;建立TCP连接-&gt;下载资源-&gt;解析页面</p>
<h2 id="DNS域名解析"><a href="#DNS域名解析" class="headerlink" title="DNS域名解析"></a>DNS域名解析</h2><p>将人们习惯使用的域名，映射为对应的ip，机器之间只能识别ip地址。<br>域名解析的步骤：以www.baidu.com为例<br>1、浏览器缓存：浏览器会按照一定的频率缓存DNS记录。<br>2、操作系统缓存：如果浏览器缓存中找不到需要的DNS记录，那就去操作系统中找（hosts文件）。<br>3、路由缓存：路由器也有DNS缓存(可能存在)。<br>4、ISP的DNS服务器：ISP是互联网服务提供商(Internet Service Provider)的简称，ISP有专门的DNS服务器应对DNS查询请求。<br>5、根服务器：ISP的DNS服务器还找不到的话，它就会向根服务器发出请求，进行递归查询（DNS服务器先问根域名服务器.域名服务器的IP地址，然后再问.com顶级域名服务器，依次类推）。<br>PS：以www.baidu.com为例说明根域名、顶级域名、一级域名等<br>根域名：为’.’,全球共13个ip地址（并不是13台机器）。<br>顶级域名(一级域名)：为www.baidu.com的顶级域名为baidu.com，主机名为www。<br>二级域名：a.www.baidu.com的二级域名为www.baidu.com，主机名为a。<br>优化方案：域名预解析<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// 告知浏览器, 当前页面要做DNS预解析</div><div class="line">&lt;meta http-equiv=&quot;x-dns-prefetch-control&quot; content=&quot;on&quot; /&gt;</div><div class="line">// 强制对DNS预解析（本网页需要跳转的页面，注意避免多页面重复DNS解析）</div><div class="line">&lt;link rel=&quot;dns-prefetch&quot; href=&quot;http://bdimg.share.baidu.com&quot; /&gt;</div></pre></td></tr></table></figure></p>
<h2 id="建立TCP连接"><a href="#建立TCP连接" class="headerlink" title="建立TCP连接"></a>建立TCP连接</h2><p>经过域名解析，浏览器拿到了服务器的IP。<br>TCP建立连接的三次握手：<br>客户端创建socket，向服务器目标端口发送连接建立请求，数据段包含位码SYN（建立联机标志位） = 1，随机数seq（顺序号码）= x，和其他TCP标志和选项。<br>服务器有一个专门处理连接请求的welcome socket，接收到连接建立请求，置位码SYN和ACK（确认标志位）为1，ack（确认号码）= x + 1，随机数seq = y，并返回。<br>客户端检查ack是否等于x + 1，等于时，将ACK置为1，SYN置为0，将ack置为y + 1发送至服务器端。<br>welcome socket检查ack等于y + 1和ACK等于1后，创建新的socket，此socket由源IP/源端口、目标IP/目标端口标识，之后客户端发送的数据都被引导向此新的socket，至此，TCP连接建立。<br>优化方案：<br>减少数据往返延迟（地理位置远近关系）可以使用CDN（客户端访问域名到距离最近的服务器）。<br>使用HTTP2（多路复用 (Multiplexing)）、header压缩（减少传输数据大小）、服务端推送（server push）（有时只需要服务器发送数据到客户端，不需要客户端-&gt;服务端—&gt;客户端这样一个来回）<br>减少cookie：每次请求都携带了本域的cookie<br>PS：虽然HTTP 1.1有长链接，但资源下载事串行的，所以推荐使用HTTP2的多了复用。</p>
<h2 id="下载资源（接收响应）"><a href="#下载资源（接收响应）" class="headerlink" title="下载资源（接收响应）"></a>下载资源（接收响应）</h2><p>避免不必要的重定向（非缓存重定向），重定向会导致浏览器再进行一次（DNS域名解析-&gt;建立TCP连接-&gt;下载资源-&gt;解析页面）。<br>避免超出并行连接阀值（浏览器会在同域名并行连接限制，一般为6个）</p>
<h2 id="解析页面（webkit工作原理）"><a href="#解析页面（webkit工作原理）" class="headerlink" title="解析页面（webkit工作原理）"></a>解析页面（webkit工作原理）</h2><p>处理HTML标记，构建DOM树。<br>处理CSS标记，构建CSSOM树。<br>将DOM树和CSSOM树融合成渲染树（会忽略不需要渲染的dom）。<br>根据渲染树来布局，计算每个节点的几何信息。<br>在屏幕上绘制各个节点。<br>中间遇到各种资源时，会进行资源的下载。<br>优化：<br>css放head中，js放body尾部，均以外链形式<br>压缩js、css等文件<br>使用CDN技术<br>使用图片精灵、webp、图片base64等<br>首屏优化（按需加载、首屏资源优先加载）<br>避免重排（开启复合层，如使用3d变换、opacity等<a href="http://div.io/topic/1348" target="_blank" rel="external">3d硬件加速的坑</a>），减少重绘<br>缓存技术：强缓存（Expires、Cache-Control：max-age=seconds）协商缓存（Last-Modified/If-Modified-Since、ETag/If-None-Match）</p>
<h1 id="CSS2Dtransform和Matrix的关系"><a href="#CSS2Dtransform和Matrix的关系" class="headerlink" title="CSS2Dtransform和Matrix的关系"></a>CSS2Dtransform和Matrix的关系</h1><p>这里transform包括：translate、scale、rotate、skew<br>没有任何变换时：matrix(1, 0, 0, 1, 0, 0)、matrix(a, b, c, d, e, f)<br>translate(30, 30) 等价于 matrix(1, 0, 0, 1, 30, 30)<br>ps：e、f分别表示x轴和y轴偏移距离<br>scale(2, 3) 等价于 matrix(2, 0, 3, 1, 0, 0)<br>ps：a、c分别表示x轴和y轴缩放比例<br>rotate(θ) 等价于 matrix(cosθ,sinθ,-sinθ,cosθ,0,0)<br>ps：a、b、c、d共同决定旋转角度θ<br>skew(θx, θy) 等价于 matrix(1,tan(θy),tan(θx),1,0,0)<br>ps：θx表示x轴倾斜的角度，θy表示y轴</p>
<h1 id="硬编码和非硬编码（软编码）的区别"><a href="#硬编码和非硬编码（软编码）的区别" class="headerlink" title="硬编码和非硬编码（软编码）的区别"></a>硬编码和非硬编码（软编码）的区别</h1><p>软编码可以在运行时确定，修改；而硬编码是不能够改变的。<br>硬编码是指将可变变量用一个固定值来代替的方法，使用这样方法，编译后，如果想更改词变量就变的非常困难。因此， 在大部分的程序语言中，可以将一个固定值定义为一个标记， 然后用这个特殊的标记来取代变量名称。 当标记名称发生改变时， 变量名不变。这样在程序进行编译时，所有的变量都不再是固定值 这样就更容易实现改变变量的目的。</p>
<h1 id="幂等"><a href="#幂等" class="headerlink" title="幂等"></a>幂等</h1><p>在编程中一个幂等操作的特点是其任意多次执行所产生的影响均与一次执行的影响相同。幂等函数，或幂等方法，是指可以使用相同参数重复执行，并能获得相同结果的函数。这些函数不会影响系统状态，也不用担心重复执行会对系统造成改变。</p>
<h1 id="Intersection-Observer"><a href="#Intersection-Observer" class="headerlink" title="Intersection Observer"></a>Intersection Observer</h1><p>2018-05-28添加<br>定义：IntersectionObserver构造函数为开发者提供了一种可以异步监听目标元素与其祖先或视窗(viewport)交叉状态的手段。祖先元素与视窗(viewport)被称为根(root)。<br>语法：<code>let io = new new IntersectionObserver(callback(entries), options)</code><br>用法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">var intersectionObserver = new IntersectionObserver(function(entries) &#123;</div><div class="line">  // entries 时一个数组，每个成员都是一个[IntersectionObserverEntry对象](https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserverEntry)。</div><div class="line">  if (entries[0].intersectionRatio &lt;= 0) return;</div><div class="line">  </div><div class="line">  // 元素与祖先元素交叉状态发生改变时触发</div><div class="line">  loadItems(10);</div><div class="line">  console.log(&apos;Loaded new items&apos;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">// start observing</div><div class="line">intersectionObserver.observe(document.querySelector(&apos;.scrollerFooter&apos;));</div></pre></td></tr></table></figure></p>
<p>属性（options）：<br>root – 所监听对象的具体祖先元素(element)。如果未传入任何值或值为null，则默认使用viewport。<br>rootMargin – 计算交叉时添加到根(root)边界盒bounding box的矩形偏移量， 可以有效的缩小或扩大根的判定范围从而满足计算需要。此属性返回的值可能与调用构造函数时指定的值不同，因此可能需要更改该值，以匹配内部要求。所有的偏移量均可用像素(pixel)(px)或百分比(percentage)(%)来表达, 默认值为”0px 0px 0px 0px”。<br>thresholds – 一个包含阈值的list, 升序排列, list中的每个阈值都是监听对象的交叉区域与边界区域的比率。当监听对象的任何阈值被越过时，都会生成一个通知(Notification)。如果构造器未传入值, 则默认值为0.<br>方法：<br>observe(element) – 使IntersectionObserver开始监听一个目标元素。<br>unobserve(element) – 使IntersectionObserver停止监听特定目标元素。<br>takeRecords() – 为所有监听目标返回一个IntersectionObserverEntry对象数组并且停止监听这些目标。<br>disconnect() – 使IntersectionObserver对象停止监听工作。<br>应用：惰性加载（lazy load）、无限滚动等<br><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/IntersectionObserver" target="_blank" rel="external">MDN-Intersection Observer</a><br><a href="http://www.ruanyifeng.com/blog/2016/11/intersectionobserver_api.html" target="_blank" rel="external">IntersectionObserver API 使用教程</a><br><a href="https://caniuse.com/#search=IntersectionObserver" target="_blank" rel="external">查看浏览器支持情况</a></p>
<h1 id="MutationObserver（异步的）"><a href="#MutationObserver（异步的）" class="headerlink" title="MutationObserver（异步的）"></a>MutationObserver（异步的）</h1><p>2018-05-28添加<br>定义：MutationObserver给开发者们提供了一种能在某个范围内的DOM树发生变化时作出适当反应的能力.该API设计用来替换掉在DOM3事件规范中引入的Mutation事件.<br>语法：<code>var observer = new MutationObserver(callback(mutations, observer));</code><br>PS：mutations 为DOM变动数组，observer 为观察器实例。<br>用法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">var observer = new MutationObserver(function (mutations, observer) &#123;</div><div class="line">  mutations.forEach(function(mutation) &#123;</div><div class="line">    console.log(mutation);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"></div><div class="line">var article = document.querySelector(&apos;article&apos;);</div><div class="line">var  options = &#123;</div><div class="line">  &apos;childList&apos;: true,</div><div class="line">  &apos;attributes&apos;:true</div><div class="line">&#125; ;</div><div class="line"></div><div class="line">// start Observer</div><div class="line">observer.observe(article, options);</div></pre></td></tr></table></figure></p>
<p>方法：<br>observe(element, options) – 给当前观察者对象注册需要观察的目标节点,在目标节点(还可以同时观察其后代节点)发生DOM变化时收到通知.<br>PS：target 为观察该节点是否会发生DOM变化.options 为一个MutationObserverInit对象,指定要观察的DOM变化类型.<br>disconnect() – 让该观察者对象停止观察指定目标的DOM变化.直到再次调用其observe()方法,该观察者对象包含的回调函数都不会再被调用.<br>takeRecords() – 清空观察者对象的记录队列,并返回里面的内容.<br><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/MutationObserver" target="_blank" rel="external">MDN-MutationObserver</a><br><a href="http://javascript.ruanyifeng.com/dom/mutationobserver.html" target="_blank" rel="external">Mutation Observer API</a></p>
<blockquote>
<p> 参考文档：<br><a href="https://http2.github.io" target="_blank" rel="external">HTTP/2</a><br><a href="https://www.cnblogs.com/geaozhang/p/7010353.html" target="_blank" rel="external">DNS域名解析的过程</a><br><a href="https://juejin.im/post/5ad578ba6fb9a028cc61b89f" target="_blank" rel="external">从输入url开始能做哪些优化</a><br><a href="http://blog.chinaunix.net/uid-28216282-id-3757849.html" target="_blank" rel="external">DNS解析过程详解</a></p>
</blockquote>

      
    </div>

    

    
    
    
	<div>
		
			<div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读，如果本文对你有帮助就记得<a href="https://github.com/fanerge/fanerge.github.io" title="谢谢亲的star">给个star</a>-------------</div>
		
	</div>
    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>Donate comment here</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>Donate</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/weixinpay.jpg" alt="余真帆-fanerge WeChat Pay"/>
        <p>WeChat Pay</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="余真帆-fanerge Alipay"/>
        <p>Alipay</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author: </strong>余真帆-fanerge</li>
  <li class="post-copyright-link">
    <strong>Post link:</strong>
    <a href="https://fanerge.github.io/2018/面试杂项.html" title="面试杂项">https://fanerge.github.io/2018/面试杂项.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> unless stating additionally.</li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/前端面试/" rel="tag"><i class="far fa-bell"></i> 前端面试</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/html5-MathML.html" rel="next" title="MathML">
                <i class="fa fa-chevron-left"></i> MathML
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/html5-DragAndDrop.html" rel="prev" title="拖放（Drag 和 Drop）">
                拖放（Drag 和 Drop） <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
<span class="jiathis_txt">分享到：</span>
<a class="jiathis_button_fav">收藏夹</a>
<a class="jiathis_button_copy">复制网址</a>
<a class="jiathis_button_email">邮件</a>
<a class="jiathis_button_weixin">微信</a>
<a class="jiathis_button_qzone">QQ空间</a>
<a class="jiathis_button_tqq">腾讯微博</a>
<a class="jiathis_button_douban">豆瓣</a>
<a class="jiathis_button_share">一键分享</a>

<a href="http://www.jiathis.com/share?uid=2140465" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a>
<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
var jiathis_config={
  data_track_clickback:true,
  summary:"",
  shortUrl:false,
  hideMore:false
}
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=2156704" charset="utf-8"></script>
<!-- JiaThis Button END -->
      
    </div>
  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zNTk4Mi8xMjUxOA=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="https://avatars3.githubusercontent.com/u/17136707?s=400&u=d7250b0655c87b8e8e1cdaf826754fe5e6f68e80&v=4"
                alt="余真帆-fanerge" />
            
              <p class="site-author-name" itemprop="name">余真帆-fanerge</p>
              <p class="site-description motion-element" itemprop="description">前端偏前工程师</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives">
                
                    <span class="site-state-item-count">187</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">29</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">57</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/fanerge" target="_blank" title="GitHub" rel="external nofollow"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:fanege@qq.com" target="_blank" title="E-Mail" rel="external nofollow"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://juejin.im/user/57cede6d5bbb50005b97536a" target="_blank" title="掘金" rel="external nofollow"><i class="fa fa-fw fa-juejin"></i>掘金</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.zhihu.com/people/fanerge" target="_blank" title="知乎" rel="external nofollow"><i class="fa fa-fw fa-zhihu"></i>知乎</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://segmentfault.com/u/fanerge/articles" target="_blank" title="Segmentfault" rel="external nofollow"><i class="fa fa-fw fa-segmentfault"></i>Segmentfault</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#防止网页被嵌入框架的代码"><span class="nav-number">1.</span> <span class="nav-text">防止网页被嵌入框架的代码</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#任何页面都不可嵌套"><span class="nav-number">1.1.</span> <span class="nav-text">任何页面都不可嵌套</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#本地域名可嵌套，其他域名不可"><span class="nav-number">1.2.</span> <span class="nav-text">本地域名可嵌套，其他域名不可</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#js如何判断是否在iframe中"><span class="nav-number">1.3.</span> <span class="nav-text">js如何判断是否在iframe中</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#比较可靠的方式"><span class="nav-number">1.4.</span> <span class="nav-text">比较可靠的方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#在meta中设置"><span class="nav-number">1.5.</span> <span class="nav-text">在meta中设置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#在http的header做手脚"><span class="nav-number">1.6.</span> <span class="nav-text">在http的header做手脚</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#在Apache、IIS、Nginc主机中设置"><span class="nav-number">1.7.</span> <span class="nav-text">在Apache、IIS、Nginc主机中设置</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#BFC"><span class="nav-number">2.</span> <span class="nav-text">BFC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#BFC的定义"><span class="nav-number">2.1.</span> <span class="nav-text">BFC的定义</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BFC的触发"><span class="nav-number">2.2.</span> <span class="nav-text">BFC的触发</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BFC的运用"><span class="nav-number">2.3.</span> <span class="nav-text">BFC的运用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Banner如何平滑的从最后一张过渡到第一张"><span class="nav-number">3.</span> <span class="nav-text">Banner如何平滑的从最后一张过渡到第一张</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Event-Loop（浏览器环境）"><span class="nav-number">4.</span> <span class="nav-text">Event Loop（浏览器环境）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#堆、栈、队列"><span class="nav-number">4.1.</span> <span class="nav-text">堆、栈、队列</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#堆（heap）"><span class="nav-number">4.1.1.</span> <span class="nav-text">堆（heap）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#栈（stack）"><span class="nav-number">4.1.2.</span> <span class="nav-text">栈（stack）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#队列（queue）"><span class="nav-number">4.1.3.</span> <span class="nav-text">队列（queue）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#js中的两个队列"><span class="nav-number">4.2.</span> <span class="nav-text">js中的两个队列</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Philip-Roberts的演讲《Help-I’m-stuck-in-an-event-loop》的event-loop-图"><span class="nav-number">4.3.</span> <span class="nav-text">Philip Roberts的演讲《Help, I’m stuck in an event-loop》的event-loop 图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#解释"><span class="nav-number">4.4.</span> <span class="nav-text">解释</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Event-Loop（Node环境）"><span class="nav-number">5.</span> <span class="nav-text">Event Loop（Node环境）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Event-Loop顺序"><span class="nav-number">5.1.</span> <span class="nav-text">Event Loop顺序</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#RegExp相关知识点"><span class="nav-number">6.</span> <span class="nav-text">RegExp相关知识点</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#正则flags的说明"><span class="nav-number">6.1.</span> <span class="nav-text">正则flags的说明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#正则表达式中特殊字符的含义"><span class="nav-number">6.2.</span> <span class="nav-text">正则表达式中特殊字符的含义</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#字符类别（Character-Classes）"><span class="nav-number">6.2.1.</span> <span class="nav-text">字符类别（Character Classes）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#"><span class="nav-number">6.2.1.1.</span> <span class="nav-text">.</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#d"><span class="nav-number">6.2.1.2.</span> <span class="nav-text">\d</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#D"><span class="nav-number">6.2.1.3.</span> <span class="nav-text">\D</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#w"><span class="nav-number">6.2.1.4.</span> <span class="nav-text">\w</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#W"><span class="nav-number">6.2.1.5.</span> <span class="nav-text">\W</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#s"><span class="nav-number">6.2.1.6.</span> <span class="nav-text">\s</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#S"><span class="nav-number">6.2.1.7.</span> <span class="nav-text">\S</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#其他"><span class="nav-number">6.2.1.8.</span> <span class="nav-text">其他</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#字符集合（Character-Sets）"><span class="nav-number">6.3.</span> <span class="nav-text">字符集合（Character Sets）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#xyz"><span class="nav-number">6.3.1.</span> <span class="nav-text">[xyz]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#xyz-1"><span class="nav-number">6.3.2.</span> <span class="nav-text">[^xyz]</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#边界（Boundaries）"><span class="nav-number">6.4.</span> <span class="nav-text">边界（Boundaries）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#-1"><span class="nav-number">6.4.1.</span> <span class="nav-text">^</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#-2"><span class="nav-number">6.4.2.</span> <span class="nav-text">$</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b"><span class="nav-number">6.4.3.</span> <span class="nav-text">\b</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分组（Grouping）与反向引用（back-references）"><span class="nav-number">6.5.</span> <span class="nav-text">分组（Grouping）与反向引用（back references）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#先行断言（lookahead）"><span class="nav-number">6.5.1.</span> <span class="nav-text">先行断言（lookahead）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#先行肯定断言"><span class="nav-number">6.5.1.1.</span> <span class="nav-text">先行肯定断言</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#先行否定断言"><span class="nav-number">6.5.1.2.</span> <span class="nav-text">先行否定断言</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#后行断言（lookbehind）"><span class="nav-number">6.5.2.</span> <span class="nav-text">后行断言（lookbehind）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#后行肯定断言"><span class="nav-number">6.5.2.1.</span> <span class="nav-text">后行肯定断言</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#后行否定断言"><span class="nav-number">6.5.2.2.</span> <span class="nav-text">后行否定断言</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#获取元素的尺寸"><span class="nav-number">7.</span> <span class="nav-text">获取元素的尺寸</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#window-getComputedStyle-element-pseudoElt"><span class="nav-number">7.1.</span> <span class="nav-text">window.getComputedStyle(element, [pseudoElt])</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#elem-getBoundingClientRect"><span class="nav-number">7.2.</span> <span class="nav-text">elem.getBoundingClientRect()</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#元素的属性"><span class="nav-number">7.3.</span> <span class="nav-text">元素的属性</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#埋点"><span class="nav-number">8.</span> <span class="nav-text">埋点</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#买点分类"><span class="nav-number">8.1.</span> <span class="nav-text">买点分类</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#适合前端埋点"><span class="nav-number">8.1.1.</span> <span class="nav-text">适合前端埋点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#适合后端埋点"><span class="nav-number">8.1.2.</span> <span class="nav-text">适合后端埋点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#前端埋点（实现步骤）"><span class="nav-number">8.2.</span> <span class="nav-text">前端埋点（实现步骤）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#埋点-1"><span class="nav-number">8.2.1.</span> <span class="nav-text">埋点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据采集（之前动态插入的ma-js）"><span class="nav-number">8.2.2.</span> <span class="nav-text">数据采集（之前动态插入的ma.js）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#后端处理"><span class="nav-number">8.2.3.</span> <span class="nav-text">后端处理</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#File"><span class="nav-number">9.</span> <span class="nav-text">File</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#files属性"><span class="nav-number">9.1.</span> <span class="nav-text">files属性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#FileReader-构造函数"><span class="nav-number">9.2.</span> <span class="nav-text">FileReader() 构造函数</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#前端错误收集"><span class="nav-number">10.</span> <span class="nav-text">前端错误收集</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#window-onerror（大部分的错误）"><span class="nav-number">10.1.</span> <span class="nav-text">window.onerror（大部分的错误）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#promise的错误处理"><span class="nav-number">10.2.</span> <span class="nav-text">promise的错误处理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#try-catch"><span class="nav-number">10.3.</span> <span class="nav-text">try catch</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#上报错误"><span class="nav-number">10.4.</span> <span class="nav-text">上报错误</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#npx"><span class="nav-number">11.</span> <span class="nav-text">npx</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#判断浏览器对某个css3是否支持"><span class="nav-number">12.</span> <span class="nav-text">判断浏览器对某个css3是否支持</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#‘样式属性名’-in-document-documentElement-style"><span class="nav-number">12.1.</span> <span class="nav-text">‘样式属性名’ in document.documentElement.style</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#supports"><span class="nav-number">12.2.</span> <span class="nav-text">@supports</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CSS-supports"><span class="nav-number">12.3.</span> <span class="nav-text">CSS.supports</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#装饰者模式"><span class="nav-number">13.</span> <span class="nav-text">装饰者模式</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#touchstart-和-click-的坑"><span class="nav-number">14.</span> <span class="nav-text">touchstart 和 click 的坑</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#产生原因："><span class="nav-number">14.1.</span> <span class="nav-text">产生原因：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#解决方案"><span class="nav-number">14.2.</span> <span class="nav-text">解决方案</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#均使用click事件（移动端存在300ms延迟）"><span class="nav-number">14.2.1.</span> <span class="nav-text">均使用click事件（移动端存在300ms延迟）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#通过UA判断设备是否为移动端，再确认事件类型"><span class="nav-number">14.2.2.</span> <span class="nav-text">通过UA判断设备是否为移动端，再确认事件类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#全部使用click，通过FastClick解决300毫秒的延迟问题"><span class="nav-number">14.2.3.</span> <span class="nav-text">全部使用click，通过FastClick解决300毫秒的延迟问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#不再绑定的时候进行判断，而是对touchstart-和-click-同时绑定，但是在-touchstart-触发的时候暂停取消后续-click-的响应。"><span class="nav-number">14.2.4.</span> <span class="nav-text">不再绑定的时候进行判断，而是对touchstart 和 click 同时绑定，但是在 touchstart 触发的时候暂停取消后续 click 的响应。</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#defer和async"><span class="nav-number">15.</span> <span class="nav-text">defer和async</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#从输入url到页面渲染优化"><span class="nav-number">16.</span> <span class="nav-text">从输入url到页面渲染优化</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#大值步骤"><span class="nav-number">16.1.</span> <span class="nav-text">大值步骤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DNS域名解析"><span class="nav-number">16.2.</span> <span class="nav-text">DNS域名解析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#建立TCP连接"><span class="nav-number">16.3.</span> <span class="nav-text">建立TCP连接</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#下载资源（接收响应）"><span class="nav-number">16.4.</span> <span class="nav-text">下载资源（接收响应）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#解析页面（webkit工作原理）"><span class="nav-number">16.5.</span> <span class="nav-text">解析页面（webkit工作原理）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CSS2Dtransform和Matrix的关系"><span class="nav-number">17.</span> <span class="nav-text">CSS2Dtransform和Matrix的关系</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#硬编码和非硬编码（软编码）的区别"><span class="nav-number">18.</span> <span class="nav-text">硬编码和非硬编码（软编码）的区别</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#幂等"><span class="nav-number">19.</span> <span class="nav-text">幂等</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Intersection-Observer"><span class="nav-number">20.</span> <span class="nav-text">Intersection Observer</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MutationObserver（异步的）"><span class="nav-number">21.</span> <span class="nav-text">MutationObserver（异步的）</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-pied-piper-alt"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">余真帆-fanerge</span>

  

  
</div>


  



  <div class="powered-by">Powered by <a class="theme-link" target="_blank" rel="external nofollow" href="https://hexo.io">Hexo</a></div>








        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="Total Visitors">
	  <span>Unique Visitor:</span>
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="Total Views">
	  <span>Page View:</span>
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.6"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.6"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.0.6"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.0.6"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.6"></script>



  



	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  
  

  

  

  

  

  <!-- 页面点击小红心 -->
  <script type="text/javascript" src="/js/src/love.js"></script>
</body>
</html>
